---
import Root from "./Root.astro";
import Navibar from "../components/Navibar.astro";
import Toolbar from "../components/Toolbar.astro";
import Footer from "../components/Footer.astro";
import LayoutDrawer from "../components/LayoutDrawer.astro";
import LayoutAside from "../components/LayoutAside.astro";
import Icon from "../components/Icon.astro";
import Popover from "../components/Popover.astro";

interface Props {
  title?: string;
  layout?: {
    hasAside?: boolean;
    hasDrawer?: boolean;
  };
}

const { title, layout = {} } = Astro.props;

---

<Root {title} {layout}>
  <Navibar />
  <Toolbar {layout} />
  <div class="layout">
    {
      layout.hasDrawer && (
        <div class="layout__drawer">
          <LayoutDrawer>
            <slot name="drawer" />
          </LayoutDrawer>
        </div>
      )
    }
    <div id="main-content" class="layout__main" tabindex="-1">
      <div class="layout__grid">
        {
          layout.hasAside && (
            <div class="layout__aside">
              <LayoutAside>
                <slot name="aside" />
              </LayoutAside>
            </div>
          )
        }
        <div class="layout__content">
          {
            layout.hasAside && (
              <div class="toolbar-mini">
                <Popover
                  id="on-this-page-menu"
                  aria-label="Open on this page menu"
                  triggerClass="button button_icon"
                  tooltipClass="text-nowrap"
                  placement="bottom-end"
                  data-drawer-open="layout-aside"
                >
                  <Fragment slot="trigger">
                    <Icon name="compass" />
                  </Fragment>
                  <Fragment slot="tooltip">
                    On this page
                  </Fragment>
                </Popover>
              </div>
            )
          }
          {
            Astro.slots.has("prepend") && (
              <div class="layout__prepend">
                <slot name="prepend" />
              </div>
            )
          }
          <div class="type spacing">
            <slot />
          </div>
          {
            Astro.slots.has("append") && (
              <div class="layout__append">
                <slot name="append" />
              </div>
            )
          }
        </div>
        <Footer classes="layout__footer" />
      </div>
    </div>
  </div>
</Root>

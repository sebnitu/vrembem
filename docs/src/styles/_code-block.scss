@use "@vrembem/core";
@use "@vrembem/core/css";
@use "@vrembem/core/palette";
@use "@vrembem/core/theme";
@use "./root";

.code-block {
  position: relative;
  font-size: core.$font-size;
  line-height: css.get("line-height");
  text-align: left;

  .pre {
    padding-right: 4em;
    border: core.$border;
    background-color: theme.get("background-dark");
  }
  
  .popover {
    @include css.override("popover", "event", click);
    @include css.override("popover", "placement", left);
    @include css.define("core", "background", palette.get("primary", 100));
    @include css.define("core", "foreground", palette.get("primary"));
  }

  @include core.media-max(root.$bp-code) {
    .pre {
      margin: auto calc(var(--layout-padding) * -1);
      border-right: none;
      border-left: none;
      border-radius: 0;
    }
  }
}

// Icons and copy button

.code-block__prompt,
.code-block__copy-button {
  position: absolute;
  top: 0.8rem;
  display: flex;
  padding: 0.5rem;
  border-radius: core.$border-radius;
  background-color: theme.get("background-dark");
}

.code-block__prompt {
  left: 0.5rem;
}

.code-block__copy-button {
  right: 1rem;
  color: theme.get("foreground-lighter");

  &:hover {
    color: theme.get("foreground-light");
  }

  @include core.media-max(root.$bp-code) {
    right: 0;
  }
}

/**
 * Modifier: inline
 */

.code-block_inline {  
  .pre {
    padding: 0.75em 4em 0.75em 2.5em;
  }

  .code-block__prompt,
  .code-block__copy-button {
    top: 0.6rem;
  }

  .popover {
    @include css.override("popover", "offset", 24);
    @include css.override("popover", "placement", bottom);
  }

  @include core.media-max(root.$bp-code) {
    .pre {
      margin: 0;
      border: core.$border;
      border-radius: css.get("border-radius");
    }

    .code-block__copy-button {
      right: 1rem;
    }
  }
}

@use "@vrembem/core/palette";
@use "@vrembem/core/theme";
@use "@vrembem/core";

.code-block {
  position: relative;
  text-align: left;

  .pre {
    background-color: theme.get("background-dark");
  }
  
  .popover {
    --vb-popover-event: click;
    --vb-popover-placement: left;
    --vb-background: #{palette.get("primary", 100)};
    --vb-foreground: #{palette.get("primary")};
  }

  @include core.media-max(700px) {
    .pre {
      margin: auto calc(var(--vb-layout-padding) * -1);
      border-radius: 0;
    }
  }
}

// Icons and copy button

.code-block__prompt,
.code-block__copy-button {
  position: absolute;
  top: 0.7rem;
  display: flex;
  padding: 0.5rem;
}

.code-block__prompt {
  left: 0.5rem;
}

.code-block__copy-button {
  right: 0.7rem;
}

/**
 * Modifier: inline
 */

.code-block_inline {
  .pre {
    padding: 0.5em 4em 0.5em 2.5em;
  }

  .code-block__prompt,
  .code-block__copy-button {
    top: 0.5rem;
  }

  .popover {
    --vb-popover-offset: 24;
    --vb-popover-placement: bottom;
  }

  @include core.media-max(700px) {
    .pre {
      margin: 0;
      border-radius: var(--vb-border-radius);
    }
  }
}

/**
 * Shiki Theme
 */

:root {
  --astro-code-color-text: #{theme.get("foreground")};
  --astro-code-token-comment: #{theme.get("foreground-lighter")};
  --astro-code-token-constant: #1b6bc6;
  --astro-code-token-string: #1b6bc6;
  --astro-code-token-keyword: #{theme.get("foreground")};
  --astro-code-token-parameter: #df7a32;
  --astro-code-token-function: #794bcf;
  --astro-code-token-string-expression: #309b4a;
  --astro-code-token-punctuation: #ce3b4a;
  --astro-code-token-link: #ce3b4a;

  &.theme-dark {
    --astro-code-color-text: #{theme.get("foreground")};
    --astro-code-token-comment: #{theme.get("foreground-lighter")};
    --astro-code-token-constant: #79B8FF;
    --astro-code-token-string: #79B8FF;
    --astro-code-token-keyword: #{theme.get("foreground")};
    --astro-code-token-parameter: #FFAB70;
    --astro-code-token-function: #B392F0;
    --astro-code-token-string-expression: #85E89D;
    --astro-code-token-punctuation: #F97583;
    --astro-code-token-link: #F97583;
  }
}

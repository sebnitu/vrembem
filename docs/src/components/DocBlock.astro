---
import Icon from './Icon.vue';
import { makeSafeForCSS } from "../modules/makeSafeForCSS";

interface Props {
  name?: string;
  type?: string;
  src?: string;
  open?: boolean;
}

const { name, type, src, open = false } = Astro.props;
const id = makeSafeForCSS(`${name}-${type}`);
const isFile = (type === 'file');
---

<article class="doc-block">
  <div class="doc-block__header">
    <div class="media media_gap-x_sm flex-align-center">
      <div class="media__obj">
        <button
          type="button" 
          id={"toggle-" + id + "-trigger"}
          data-toggle={"toggle-" + id}
          aria-controls={"toggle-" + id}
          aria-label={`Toggle ${id} file contents`}
          aria-expanded={open ? "true" : "false"}
          class="toggle-trigger button button_icon button_size_sm"
        >
          <Icon name="chevron-right" iconClass="icon_size_sm" />
        </button>
      </div>
      <div class="media__body flex flex-align-center flex-gap-x flex-wrap">
        <h3 id={id} class="flex-grow-1">{name}</h3>
        <code>
          <a class="link font-size-sm" target="_blank" href={`https://github.com/sebnitu/vrembem/blob/next/packages/${src}`}>
            {src}
          </a>
        </code>
      </div>
    </div>
  </div>
  <div 
    id={"toggle-" + id}
    aria-labelledby={"toggle-" + id + "-trigger"}
    aria-hidden={open ? "false" : "true"}  
    class="toggle-content doc-block__content"
  >
    {
      isFile ? (
        <div class="doc-block__file">
          <slot />
        </div>
      ) : (
        <div class="doc-block__intro">
          <p>Type: <code>{type}</code></p>
          <slot />
        </div>
      )
    }
    {
      Astro.slots.has("arguments") && (
        <div class="doc-block__arguments">
          <h4 id={id + '-arguments'}>Arguments</h4>
          <slot name="arguments" />
        </div>
      )
    }
    {
      Astro.slots.has("example") && (
        <div class="doc-block__example">
          <h4 id={id + '-example'}>Example</h4>
          <slot name="example" />
        </div>
      )
    }
  </div>
</article>

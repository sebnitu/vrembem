{%- comment -%}
# Options
  src: [string] # The file name we're pointing to
  context: [page object] # The context that we build the asset path for
{%- endcomment -%}

{%- comment -%}
  Check if we're requesting a relative path
{%- endcomment -%}
{%- if include.src contains './' -%}
  {{- include.src | remove: './' | relative_url -}}
{%- else -%}

  {%- comment -%}
    Assign our page context
  {%- endcomment -%}
  {%- assign context = include.context | default: page -%}

  {%- comment -%}
    Get our page type and default to pages
  {%- endcomment -%}
  {%- assign type = context.collection | default: 'pages' -%}

  {%- comment -%}
    Get page path and remove extension
  {%- endcomment -%}
  {%- assign path = context.path | split:"." | first -%}

  {%- comment -%}
    Get the filename if it's a post or collection
  {%- endcomment -%}
  {%- if context.collection -%}
    {%- assign path = path | remove: '/#excerpt' | split: '/' | last -%}
  {%- endif -%}

  {%- comment -%}
    Put together our asset parts
  {%- endcomment -%}
  {%- assign asset = '/assets/' | append: type | append: '/' | append: path | append: '/' | append: include.src -%}

  {%- comment -%}
    Return asset string
  {%- endcomment -%}
  {{- asset | relative_url -}}

{%- endif -%}

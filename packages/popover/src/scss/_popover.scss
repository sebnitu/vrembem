@use "@vrembem/core";
@use "@vrembem/core/css";
@use "./variables" as var;

$_offset: calc(calc(css.get("popover", "offset") + 1) * 1px);

#{core.bem("popover")} {
  position: absolute;
  z-index: var.$z-index;
  top: 100%;
  left: 0;
  display: block;
  width: var.$width;
  max-width: var.$max-width;
  margin: calc(css.get("popover", "offset") * 1px) 0 0;
  padding: var.$padding;
  border: var.$border;
  border-radius: var.$border-radius;
  background: var.$background;
  background-clip: var.$background-clip;
  box-shadow: var.$shadow;
  color: var.$foreground;
  font-size: var.$font-size;
  line-height: var.$line-height;
  opacity: 0;
  pointer-events: none;
  // TODO: Move this into variables.
  transition-property: opacity; // Adding transform transition causes too many issues with popper.
  transition-duration: css.get("transition-duration-short");
  transition-timing-function: css.get("transition-timing-function");

  &::before {
    content: "";
    position: absolute;
    inset: auto 0 100%;
    width: 100%;
    height: $_offset;
  }

  &.is-active {
    z-index: (var.$z-index + 1);
    opacity: 1;
    pointer-events: auto;
  }

  &:hover,
  &:focus,
  &:focus-within {
    z-index: (var.$z-index + 2);
  }
}

#{core.bem("popover")}[data-popper-placement^="top"] {
  margin: 0 0 calc(css.get("popover", "offset") * 1px) 0;

  &::before {
    inset: 100% 0 auto;
    width: 100%;
    height: $_offset;
  }
}

#{core.bem("popover")}[data-popper-placement^="bottom"] {
  margin: calc(css.get("popover", "offset") * 1px) 0 0 0;

  &::before {
    inset: auto 0 100%;
    width: 100%;
    height: $_offset;
  }
}

#{core.bem("popover")}[data-popper-placement^="left"] {
  margin: 0 calc(css.get("popover", "offset") * 1px) 0 0;

  &::before {
    inset: 0 auto 0 100%;
    width: $_offset;
    height: 100%;
  }
}

#{core.bem("popover")}[data-popper-placement^="right"] {
  margin: 0 0 0 calc(css.get("popover", "offset") * 1px);

  &::before {
    inset: 0 100% 0 auto;
    width: $_offset;
    height: 100%;
  }
}

const t=(t,e)=>{e&&document.querySelectorAll(e).forEach(e=>{t?(e.inert=!0,e.setAttribute("aria-hidden",!0)):(e.inert=null,e.removeAttribute("aria-hidden"))})},e=(t,e)=>{e&&document.querySelectorAll(e).forEach(e=>{t?e.style.overflow="hidden":e.style.removeProperty("overflow")})},s=(t=null)=>{t&&t.memory&&t.memory.trigger&&(t.memory.trigger.focus(),t.memory.trigger=null)};class i{constructor(){this.target=null,this.__handlerFocusTrap=this.handlerFocusTrap.bind(this)}init(t){this.target=t,this.inner=this.target.querySelector('[tabindex="-1"]'),this.focusable=this.getFocusable(),this.focusable.length?(this.focusableFirst=this.focusable[0],this.focusableLast=this.focusable[this.focusable.length-1],this.target.addEventListener("keydown",this.__handlerFocusTrap)):this.target.addEventListener("keydown",this.handlerFocusLock)}destroy(){this.target&&(this.inner=null,this.focusable=null,this.focusableFirst=null,this.focusableLast=null,this.target.removeEventListener("keydown",this.__handlerFocusTrap),this.target.removeEventListener("keydown",this.handlerFocusLock),this.target=null)}handlerFocusTrap(t){("Tab"===t.key||9===t.keyCode)&&(t.shiftKey?document.activeElement!==this.focusableFirst&&document.activeElement!==this.inner||(this.focusableLast.focus(),t.preventDefault()):document.activeElement!==this.focusableLast&&document.activeElement!==this.inner||(this.focusableFirst.focus(),t.preventDefault()))}handlerFocusLock(t){("Tab"===t.key||9===t.keyCode)&&t.preventDefault()}getFocusable(){const t=[],e=document.activeElement,s=this.inner?this.inner.scrollTop:0;return this.target.querySelectorAll('a[href]:not([disabled]),button:not([disabled]),textarea:not([disabled]),input[type="text"]:not([disabled]),input[type="radio"]:not([disabled]),input[type="checkbox"]:not([disabled]),select:not([disabled]),[tabindex]:not([tabindex="-1"])').forEach(e=>{e.focus(),e===document.activeElement&&t.push(e)}),this.inner&&(this.inner.scrollTop=s),e.focus(),t}}const n=function(t,e=0){return"string"!=typeof t?t:e?document.querySelector(t):document.querySelectorAll(t)},a=(t,e)=>new Promise(s=>{e.transition?(t.classList.remove(e.stateClosed),t.classList.add(e.stateOpening),t.addEventListener("transitionend",function i(){t.classList.add(e.stateOpened),t.classList.remove(e.stateOpening),s(t),this.removeEventListener("transitionend",i)})):(t.classList.add(e.stateOpened),t.classList.remove(e.stateClosed),s(t))}),o=(t,e)=>new Promise(s=>{e.transition?(t.classList.add(e.stateClosing),t.classList.remove(e.stateOpened),t.addEventListener("transitionend",function i(){t.classList.remove(e.stateClosing),t.classList.add(e.stateClosed),s(t),this.removeEventListener("transitionend",i)})):(t.classList.add(e.stateClosed),t.classList.remove(e.stateOpened),s(t))});var r={autoInit:!1,dataModal:"modal",dataDialog:"modal-dialog",dataOpen:"modal-open",dataClose:"modal-close",dataFocus:"modal-focus",dataRequired:"modal-required",stateOpened:"is-opened",stateOpening:"is-opening",stateClosing:"is-closing",stateClosed:"is-closed",selectorInert:null,selectorOverflow:"body",customEventPrefix:"modal:",moveModals:{ref:null,type:null},setTabindex:!0,transition:!0};async function l(t){if(this.working)return;const e=t.target.closest(`[data-${this.settings.dataOpen}]`);if(e){t.preventDefault();const s=e.getAttribute("data-"+this.settings.dataOpen),i=t.target.closest(`[data-${this.settings.dataModal}]`);return i||(this.memory.trigger=e),await this.close(!i),void this.open(s)}if(t.target.closest(`[data-${this.settings.dataClose}]`))return t.preventDefault(),void this.close();!t.target.hasAttribute("data-"+this.settings.dataModal)||t.target.hasAttribute("data-"+this.settings.dataRequired)||this.close()}function d(t){if(!this.working&&("Escape"===t.key||27===t.keyCode)){const t=document.querySelector(`[data-${this.settings.dataModal}].${this.settings.stateOpened}`);t&&!t.hasAttribute("data-"+this.settings.dataRequired)&&this.close()}}export default class{constructor(t){this.defaults=r,this.settings={...this.defaults,...t},this.working=!1,this.memory={},this.focusTrap=new i,this.__handlerClick=l.bind(this),this.__handlerKeyup=d.bind(this),this.settings.autoInit&&this.init()}init(t=null){t&&(this.settings={...this.settings,...t}),this.moveModals(),this.setTabindex(this.settings.setTabindex),this.setInitialState(),document.addEventListener("click",this.__handlerClick,!1),document.addEventListener("touchend",this.__handlerClick,!1),document.addEventListener("keyup",this.__handlerKeyup,!1)}destroy(){this.memory={},document.removeEventListener("click",this.__handlerClick,!1),document.removeEventListener("touchend",this.__handlerClick,!1),document.removeEventListener("keyup",this.__handlerKeyup,!1)}getModal(t){return"string"!=typeof t?t:document.querySelector(`[data-${this.settings.dataModal}="${t}"]`)}modalNotFound(t){return Promise.reject(new Error(`Did not find modal with key: "${t}"`))}setTabindex(t=!0){((t,e)=>{e&&document.querySelectorAll(e).forEach(e=>{t?e.setAttribute("tabindex","-1"):e.removeAttribute("tabindex")})})(t,`\n      [data-${this.settings.dataModal}]\n      [data-${this.settings.dataDialog}]\n    `)}setInitialState(){var i;i=this,document.querySelectorAll(`[data-${i.settings.dataModal}]`).forEach(n=>{n.classList.contains(i.settings.stateOpened)&&(t(!1,i.settings.selectorInert),e(!1,i.settings.selectorOverflow),s(i),i.focusTrap.destroy()),((t,...e)=>{(t=t.forEach?t:[t]).forEach(t=>{t.classList.remove(...e)})})(n,i.settings.stateOpened,i.settings.stateOpening,i.settings.stateClosing),((t,...e)=>{(t=t.forEach?t:[t]).forEach(t=>{t.classList.add(...e)})})(n,i.settings.stateClosed)})}moveModals(t=this.settings.moveModals.type,e=this.settings.moveModals.ref){const s=document.querySelectorAll(`[data-${this.settings.dataModal}]`);s.length&&function(t,e,s=!1){if(s){const i=n(t);if(!i.length)throw new Error(`Move target element "${t}" not found!`);const a=n(s,1);if(!a)throw new Error(`Move reference element "${s}" not found!`);i.forEach(t=>{switch(e){case"after":return a.after(t),{ref:a,el:t,type:e};case"before":return a.before(t),{ref:a,el:t,type:e};case"append":return a.append(t),{ref:a,el:t,type:e};case"prepend":return a.prepend(t),{ref:a,el:t,type:e};default:throw new Error(`Move type "${e}" does not exist!`)}})}}(s,t,e)}async open(s){const i=this.getModal(s);return i?((t,...e)=>(t=[].slice.call(t=t.forEach?t:[t]),e.some(e=>t.some(t=>{if(t.classList.contains(e))return!0}))))(i,this.settings.stateClosed)?(this.working=!0,e(!0,this.settings.selectorOverflow),await a(i,this.settings),this.focusTrap.init(i),((t,e)=>{const s=t.querySelector(`[data-${this.settings.dataFocus}]`);if(s)s.focus();else{const e=t.querySelector('[tabindex="-1"]');e&&e.focus()}})(i),t(!0,this.settings.selectorInert),i.dispatchEvent(new CustomEvent(this.settings.customEventPrefix+"opened",{bubbles:!0})),this.working=!1,i):i:this.modalNotFound(s)}async close(i=!0){const n=document.querySelector(`[data-${this.settings.dataModal}].${this.settings.stateOpened}`);return n?(this.working=!0,t(!1,this.settings.selectorInert),e(!1,this.settings.selectorOverflow),await o(n,this.settings),i&&s(this),this.focusTrap.destroy(),n.dispatchEvent(new CustomEvent(this.settings.customEventPrefix+"closed",{bubbles:!0})),this.working=!1,n):n}}
//# sourceMappingURL=modal.modern.js.map

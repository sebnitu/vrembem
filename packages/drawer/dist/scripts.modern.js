const t=(t,e)=>{e&&document.querySelectorAll(e).forEach(e=>{t?(e.inert=!0,e.setAttribute("aria-hidden",!0)):(e.inert=null,e.removeAttribute("aria-hidden"))})},e=(t,e)=>{e&&document.querySelectorAll(e).forEach(e=>{t?e.style.overflow="hidden":e.style.removeProperty("overflow")})},s=(t,...e)=>{(t=t.forEach?t:[t]).forEach(t=>{t.classList.add(...e)})},i=(t,e)=>{const s=t.querySelector(`[data-${e.dataFocus}]`);if(s)s.focus();else{const e=t.querySelector('[tabindex="-1"]');e&&e.focus()}};class a{constructor(){this.target=null,this.__handlerFocusTrap=this.handlerFocusTrap.bind(this)}init(t){this.target=t,this.inner=this.target.querySelector('[tabindex="-1"]'),this.focusable=this.getFocusable(),this.focusable.length?(this.focusableFirst=this.focusable[0],this.focusableLast=this.focusable[this.focusable.length-1],this.target.addEventListener("keydown",this.__handlerFocusTrap)):this.target.addEventListener("keydown",this.handlerFocusLock)}destroy(){this.target&&(this.inner=null,this.focusable=null,this.focusableFirst=null,this.focusableLast=null,this.target.removeEventListener("keydown",this.__handlerFocusTrap),this.target.removeEventListener("keydown",this.handlerFocusLock),this.target=null)}handlerFocusTrap(t){("Tab"===t.key||9===t.keyCode)&&(t.shiftKey?document.activeElement!==this.focusableFirst&&document.activeElement!==this.inner||(this.focusableLast.focus(),t.preventDefault()):document.activeElement!==this.focusableLast&&document.activeElement!==this.inner||(this.focusableFirst.focus(),t.preventDefault()))}handlerFocusLock(t){("Tab"===t.key||9===t.keyCode)&&t.preventDefault()}getFocusable(){const t=[],e=document.activeElement,s=this.inner?this.inner.scrollTop:0;return this.target.querySelectorAll('a[href]:not([disabled]),button:not([disabled]),textarea:not([disabled]),input[type="text"]:not([disabled]),input[type="radio"]:not([disabled]),input[type="checkbox"]:not([disabled]),select:not([disabled]),[tabindex]:not([tabindex="-1"])').forEach(e=>{e.focus(),e===document.activeElement&&t.push(e)}),this.inner&&(this.inner.scrollTop=s),e.focus(),t}}const n=(t,...e)=>(t=[].slice.call(t=t.forEach?t:[t]),e.some(e=>t.some(t=>{if(t.classList.contains(e))return!0}))),r=(t,...e)=>{(t=t.forEach?t:[t]).forEach(t=>{t.classList.remove(...e)})},o=(t,e)=>new Promise(s=>{e.transition?(t.classList.remove(e.stateClosed),t.classList.add(e.stateOpening),t.addEventListener("transitionend",function i(){t.classList.add(e.stateOpened),t.classList.remove(e.stateOpening),s(t),this.removeEventListener("transitionend",i)})):(t.classList.add(e.stateOpened),t.classList.remove(e.stateClosed),s(t))}),d=(t,e)=>new Promise(s=>{e.transition?(t.classList.add(e.stateClosing),t.classList.remove(e.stateOpened),t.addEventListener("transitionend",function i(){t.classList.remove(e.stateClosing),t.classList.add(e.stateClosed),s(t),this.removeEventListener("transitionend",i)})):(t.classList.add(e.stateClosed),t.classList.remove(e.stateOpened),s(t))});var l={autoInit:!1,dataDrawer:"drawer",dataDialog:"drawer-dialog",dataToggle:"drawer-toggle",dataOpen:"drawer-open",dataClose:"drawer-close",dataBreakpoint:"drawer-breakpoint",dataFocus:"drawer-focus",stateOpened:"is-opened",stateOpening:"is-opening",stateClosing:"is-closing",stateClosed:"is-closed",classModal:"drawer_modal",selectorInert:null,selectorOverflow:null,breakpoints:{xs:"480px",sm:"620px",md:"760px",lg:"990px",xl:"1380px"},customEventPrefix:"drawer:",stateSave:!0,stateKey:"DrawerState",setTabindex:!0,transition:!0};async function c(t,e){const i=e.getDrawer(t);return i?n(i,e.settings.classModal)?void 0:(s(i,e.settings.classModal),s(i,e.settings.stateClosed),r(i,e.settings.stateOpened),i.dispatchEvent(new CustomEvent(e.settings.customEventPrefix+"toModal",{bubbles:!0})),i):e.drawerNotFound(t)}async function h(i,a){const o=a.getDrawer(i);return o?n(o,a.settings.classModal)?(t(!1,a.settings.selectorInert),e(!1,a.settings.selectorOverflow),r(o,a.settings.classModal),a.focusTrap.destroy(),i=o.getAttribute("data-"+a.settings.dataDrawer),a.state[i]==a.settings.stateOpened&&(s(o,a.settings.stateOpened),r(o,a.settings.stateClosed)),o.dispatchEvent(new CustomEvent(a.settings.customEventPrefix+"toDefault",{bubbles:!0})),o):void 0:a.drawerNotFound(i)}class u{constructor(t){this.mediaQueryLists=[],this.parent=t,this.__check=this.check.bind(this)}init(){document.querySelectorAll(`[data-${this.parent.settings.dataBreakpoint}]`).forEach(t=>{const e=t.getAttribute("data-"+this.parent.settings.dataDrawer),s=t.getAttribute("data-"+this.parent.settings.dataBreakpoint),i=window.matchMedia("(min-width:"+(this.parent.settings.breakpoints[s]?this.parent.settings.breakpoints[s]:s)+")");this.match(i,t),i.addListener(this.__check),this.mediaQueryLists.push({mql:i,drawer:e})})}destroy(){this.mediaQueryLists&&this.mediaQueryLists.length&&this.mediaQueryLists.forEach(t=>{t.mql.removeListener(this.__check)}),this.mediaQueryLists=null}check(t=null){this.mediaQueryLists&&this.mediaQueryLists.length&&(this.mediaQueryLists.forEach(e=>{if(t&&t.media!=e.mql.media)return;const s=document.querySelector(`[data-${this.parent.settings.dataDrawer}="${e.drawer}"]`);s&&this.match(e.mql,s)}),document.dispatchEvent(new CustomEvent(this.parent.settings.customEventPrefix+"breakpoint",{bubbles:!0})))}match(t,e){t.matches?h(e,this.parent):c(e,this.parent)}}function g(t){if(this.working)return;let e=t.target.closest(`[data-${this.settings.dataToggle}]`);if(e){const s=e.getAttribute("data-"+this.settings.dataToggle);return this.memory.trigger=e,this.toggle(s),void t.preventDefault()}if(e=t.target.closest(`[data-${this.settings.dataOpen}]`),e){const s=e.getAttribute("data-"+this.settings.dataOpen);return this.memory.trigger=e,this.open(s),void t.preventDefault()}if(e=t.target.closest(`[data-${this.settings.dataClose}]`),e){const s=e.getAttribute("data-"+this.settings.dataClose);if(s)this.memory.trigger=e,this.close(s);else{const e=t.target.closest(`[data-${this.settings.dataDrawer}]`);e&&this.close(e)}t.preventDefault()}else t.target.hasAttribute("data-"+this.settings.dataDrawer)&&this.close(t.target)}function m(t){if(!this.working&&27==t.keyCode){const t=document.querySelector(`.${this.settings.classModal}.${this.settings.stateOpened}`);t&&this.close(t)}}function p(t,e){if(!e.stateSave)return f(e);const s=localStorage.getItem(e.stateKey)?JSON.parse(localStorage.getItem(e.stateKey)):{};return(t?[t]:document.querySelectorAll(`[data-${e.dataDrawer}]`)).forEach(t=>{if(n(t,e.classModal))return;const i=t.getAttribute("data-"+e.dataDrawer);s[i]=n(t,e.stateOpened)?e.stateOpened:e.stateClosed}),localStorage.setItem(e.stateKey,JSON.stringify(s)),s}function f(t){return localStorage.getItem(t.stateKey)&&localStorage.removeItem(t.stateKey),{}}export default class{constructor(t){this.defaults=l,this.settings={...this.defaults,...t},this.working=!1,this.memory={},this.state={},this.focusTrap=new a,this.breakpoint=new u(this),this.__handlerClick=g.bind(this),this.__handlerKeyup=m.bind(this),this.settings.autoInit&&this.init()}init(t=null){t&&(this.settings={...this.settings,...t}),this.stateSet(),this.setTabindex(this.settings.setTabindex),this.breakpoint.init(),document.addEventListener("click",this.__handlerClick,!1),document.addEventListener("touchend",this.__handlerClick,!1),document.addEventListener("keyup",this.__handlerKeyup,!1)}destroy(){this.breakpoint.destroy(),this.memory={},this.state={},localStorage.removeItem(this.settings.stateKey),document.removeEventListener("click",this.__handlerClick,!1),document.removeEventListener("touchend",this.__handlerClick,!1),document.removeEventListener("keyup",this.__handlerKeyup,!1)}getDrawer(t){return"string"!=typeof t?t:document.querySelector(`[data-${this.settings.dataDrawer}="${t}"]`)}drawerNotFound(t){return Promise.reject(new Error(`Did not find drawer with key: "${t}"`))}setTabindex(t=!0){((t,e)=>{e&&document.querySelectorAll(e).forEach(e=>{t?e.setAttribute("tabindex","-1"):e.removeAttribute("tabindex")})})(t,`\n      [data-${this.settings.dataDrawer}]\n      [data-${this.settings.dataDialog}]\n    `)}stateSet(){this.state=function(t){if(!t.stateSave)return f(t);if(!localStorage.getItem(t.stateKey))return p(null,t);const e=JSON.parse(localStorage.getItem(t.stateKey));return Object.keys(e).forEach(i=>{const a=document.querySelector(`[data-${t.dataDrawer}="${i}"]`);a&&(e[i]==t.stateOpened?s(a,t.stateOpened):r(a,t.stateOpened))}),e}(this.settings)}stateSave(t=null){this.state=p(t,this.settings)}stateClear(){this.state=f(this.settings)}switchToDefault(t){return h(t,this)}switchToModal(t){return c(t,this)}async toggle(t){const e=this.getDrawer(t);return e?n(e,this.settings.stateOpened)?this.close(e):this.open(e):this.drawerNotFound(t)}async open(s){const a=this.getDrawer(s);if(!a)return this.drawerNotFound(s);if(n(a,this.settings.stateOpened))return i(a,this.settings),a;{this.working=!0;const s=n(a,this.settings.classModal);return s&&e(!0,this.settings.selectorOverflow),await o(a,this.settings),this.stateSave(a),s&&(this.focusTrap.init(a),t(!0,this.settings.selectorInert)),i(a,this.settings),a.dispatchEvent(new CustomEvent(this.settings.customEventPrefix+"opened",{bubbles:!0})),this.working=!1,a}}async close(s){const i=this.getDrawer(s);return i?n(i,this.settings.stateOpened)?(this.working=!0,n(i,this.settings.classModal)&&(t(!1,this.settings.selectorInert),e(!1,this.settings.selectorOverflow)),await d(i,this.settings),this.stateSave(i),((t=null)=>{t&&t.memory&&t.memory.trigger&&(t.memory.trigger.focus(),t.memory.trigger=null)})(this),this.focusTrap.destroy(),i.dispatchEvent(new CustomEvent(this.settings.customEventPrefix+"closed",{bubbles:!0})),this.working=!1,i):i:this.drawerNotFound(s)}}
//# sourceMappingURL=scripts.modern.js.map

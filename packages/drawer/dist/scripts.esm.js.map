{"version":3,"file":"scripts.esm.js","sources":["../../core/src/js/accessibility.js","../../core/src/js/addClass.js","../../core/src/js/focus.js","../../core/src/js/hasClass.js","../../core/src/js/removeClass.js","../../core/src/js/transition.js","../../core/src/js/variables.js","../src/js/defaults.js","../src/js/switchTo.js","../src/js/breakpoint.js","../src/js/handlers.js","../src/js/state.js","../index.js"],"sourcesContent":["export const setInert = (state, selector) => {\n  if (selector) {\n    const els = document.querySelectorAll(selector);\n    els.forEach((el) => {\n      if (state) {\n        el.inert = true;\n        el.setAttribute('aria-hidden', true);\n      } else {\n        el.inert = null;\n        el.removeAttribute('aria-hidden');\n      }\n    });\n  }\n};\n\nexport const setOverflowHidden = (state, selector) => {\n  if (selector) {\n    const els = document.querySelectorAll(selector);\n    els.forEach((el) => {\n      if (state) {\n        el.style.overflow = 'hidden';\n      } else {\n        el.style.removeProperty('overflow');\n      }\n    });\n  }\n};\n\nexport const setTabindex = (state, selector) => {\n  if (selector) {\n    const els = document.querySelectorAll(selector);\n    els.forEach((el) => {\n      if (state) {\n        el.setAttribute('tabindex', '-1');\n      } else {\n        el.removeAttribute('tabindex');\n      }\n    });\n  }\n};\n","/**\n * Adds a class or classes to an element or NodeList\n * ---\n * @param {Node || NodeList} el - Element(s) to add class(es) to\n * @param {String || Array} cl - Class(es) to add\n */\n\nexport const addClass = (el, ...cl) => {\n  el = (el.forEach) ? el : [el];\n  el.forEach((el) => {\n    el.classList.add(...cl);\n  });\n};\n","export const focusTarget = (target, settings) => {\n  const innerFocus = target.querySelector(\n    `[data-${settings.dataFocus}]`\n  );\n  if (innerFocus) {\n    innerFocus.focus();\n  } else {\n    const innerElement = target.querySelector('[tabindex=\"-1\"]');\n    if (innerElement) innerElement.focus();\n  }\n};\n\nexport const focusTrigger = (obj = null) => {\n  if (!obj || !obj.memory || !obj.memory.trigger) return;\n  obj.memory.trigger.focus();\n  obj.memory.trigger = null;\n};\n\nexport class FocusTrap {\n  constructor() {\n    this.target = null;\n    this.__handlerFocusTrap = this.handlerFocusTrap.bind(this);\n  }\n\n  init(target) {\n    this.target = target;\n    this.inner = this.target.querySelector('[tabindex=\"-1\"]');\n    this.focusable = this.getFocusable();\n    if (this.focusable.length) {\n      this.focusableFirst = this.focusable[0];\n      this.focusableLast = this.focusable[this.focusable.length - 1];\n      this.target.addEventListener('keydown', this.__handlerFocusTrap);\n    } else {\n      this.target.addEventListener('keydown', this.handlerFocusLock);\n    }\n  }\n\n  destroy() {\n    if (!this.target) return;\n    this.inner = null;\n    this.focusable = null;\n    this.focusableFirst = null;\n    this.focusableLast = null;\n    this.target.removeEventListener('keydown', this.__handlerFocusTrap);\n    this.target.removeEventListener('keydown', this.handlerFocusLock);\n    this.target = null;\n  }\n\n  handlerFocusTrap(event) {\n    const isTab = (event.key === 'Tab' || event.keyCode === 9);\n    if (!isTab) return;\n    if (event.shiftKey) {\n      if (\n        document.activeElement === this.focusableFirst ||\n        document.activeElement === this.inner\n      ) {\n        this.focusableLast.focus();\n        event.preventDefault();\n      }\n    } else {\n      if (\n        document.activeElement === this.focusableLast ||\n        document.activeElement === this.inner\n      ) {\n        this.focusableFirst.focus();\n        event.preventDefault();\n      }\n    }\n  }\n\n  handlerFocusLock(event) {\n    const isTab = (event.key === 'Tab' || event.keyCode === 9);\n    if (isTab) event.preventDefault();\n  }\n\n  getFocusable() {\n    const focusable = [];\n    const initFocus = document.activeElement;\n    const initScrollTop = (this.inner) ? this.inner.scrollTop : 0;\n\n    this.target\n      .querySelectorAll('a[href]:not([disabled]),button:not([disabled]),textarea:not([disabled]),input[type=\"text\"]:not([disabled]),input[type=\"radio\"]:not([disabled]),input[type=\"checkbox\"]:not([disabled]),select:not([disabled]),[tabindex]:not([tabindex=\"-1\"])')\n      .forEach((el) => {\n        el.focus();\n        if (el === document.activeElement) {\n          focusable.push(el);\n        }\n      });\n\n    if (this.inner) this.inner.scrollTop = initScrollTop;\n    initFocus.focus();\n    return focusable;\n  }\n}\n","/**\n * Checks an element or NodeList whether they contain a class or classes\n * Ref: https://davidwalsh.name/nodelist-array\n * ---\n * @param {Node} el - Element(s) to check class(es) on\n * @param {String || Array} c - Class(es) to check\n * @returns {Boolean} - Returns true if class exists, otherwise false\n */\n\nexport const hasClass = (el, ...cl) => {\n  el = (el.forEach) ? el : [el];\n  el = [].slice.call(el);\n\n  return cl.some((cl) => {\n    return el.some((el) => {\n      if (el.classList.contains(cl)) return true;\n    });\n  });\n};\n","/**\n * Remove a class or classes from an element or NodeList\n * ---\n * @param {Node || NodeList} el - Element(s) to remove class(es) from\n * @param {String || Array} cl - Class(es) to remove\n */\n\nexport const removeClass = (el, ...cl) => {\n  el = (el.forEach) ? el : [el];\n  el.forEach((el) => {\n    el.classList.remove(...cl);\n  });\n};\n","export const openTransition = (el, settings) => {\n  return new Promise((resolve) => {\n    if (settings.transition) {\n      el.classList.remove(settings.stateClosed);\n      el.classList.add(settings.stateOpening);\n      el.addEventListener('transitionend', function _f() {\n        el.classList.add(settings.stateOpened);\n        el.classList.remove(settings.stateOpening);\n        resolve(el);\n        this.removeEventListener('transitionend', _f);\n      });\n    } else {\n      el.classList.add(settings.stateOpened);\n      el.classList.remove(settings.stateClosed);\n      resolve(el);\n    }\n  });\n};\n\nexport const closeTransition = (el, settings) => {\n  return new Promise((resolve) => {\n    if (settings.transition) {\n      el.classList.add(settings.stateClosing);\n      el.classList.remove(settings.stateOpened);\n      el.addEventListener('transitionend', function _f() {\n        el.classList.remove(settings.stateClosing);\n        el.classList.add(settings.stateClosed);\n        resolve(el);\n        this.removeEventListener('transitionend', _f);\n      });\n    } else {\n      el.classList.add(settings.stateClosed);\n      el.classList.remove(settings.stateOpened);\n      resolve(el);\n    }\n  });\n};\n","export const breakpoints = {\n  xs: '480px',\n  sm: '620px',\n  md: '760px',\n  lg: '990px',\n  xl: '1380px'\n};\n","import { breakpoints } from '@vrembem/core/index';\n\nexport default {\n  autoInit: false,\n\n  // Data attributes\n  dataDrawer: 'drawer',\n  dataDialog: 'drawer-dialog',\n  dataToggle: 'drawer-toggle',\n  dataOpen: 'drawer-open',\n  dataClose: 'drawer-close',\n  dataBreakpoint: 'drawer-breakpoint',\n  dataFocus: 'drawer-focus',\n\n  // State classes\n  stateOpened: 'is-opened',\n  stateOpening: 'is-opening',\n  stateClosing: 'is-closing',\n  stateClosed: 'is-closed',\n\n  // Classes\n  classModal: 'drawer_modal',\n\n  // Selectors\n  selectorInert: null,\n  selectorOverflow: null,\n\n  // Feature toggles\n  breakpoints: breakpoints,\n  customEventPrefix: 'drawer:',\n  stateSave: true,\n  stateKey: 'DrawerState',\n  setTabindex: true,\n  transition: true\n};\n","import { addClass, hasClass, removeClass } from '@vrembem/core/index';\nimport { setInert, setOverflowHidden } from '@vrembem/core/index';\n\nexport async function switchToModal(drawerKey, obj) {\n  // Initial guards\n  const drawer = obj.getDrawer(drawerKey);\n  if (!drawer) return obj.drawerNotFound(drawerKey);\n  if (hasClass(drawer, obj.settings.classModal)) return;\n\n  // Enable modal state\n  addClass(drawer, obj.settings.classModal);\n  addClass(drawer, obj.settings.stateClosed);\n  removeClass(drawer, obj.settings.stateOpened);\n\n  // Dispatch custom event\n  drawer.dispatchEvent(new CustomEvent(obj.settings.customEventPrefix + 'toModal', {\n    bubbles: true\n  }));\n  return drawer;\n}\n\nexport async function switchToDefault(drawerKey, obj) {\n  // Initial guards\n  const drawer = obj.getDrawer(drawerKey);\n  if (!drawer) return obj.drawerNotFound(drawerKey);\n  if (!hasClass(drawer, obj.settings.classModal)) return;\n\n  // Tear down modal state\n  setInert(false, obj.settings.selectorInert);\n  setOverflowHidden(false, obj.settings.selectorOverflow);\n  removeClass(drawer, obj.settings.classModal);\n  obj.focusTrap.destroy();\n\n  // Restore drawers saved state\n  drawerKey = drawer.getAttribute(`data-${obj.settings.dataDrawer}`);\n  const drawerState = obj.state[drawerKey];\n  if (drawerState == obj.settings.stateOpened) {\n    addClass(drawer, obj.settings.stateOpened);\n    removeClass(drawer, obj.settings.stateClosed);\n  }\n\n  // Dispatch custom event\n  drawer.dispatchEvent(new CustomEvent(obj.settings.customEventPrefix + 'toDefault', {\n    bubbles: true\n  }));\n  return drawer;\n}\n","import { switchToDefault, switchToModal } from './switchTo';\n\nexport class Breakpoint {\n  constructor(parent) {\n    this.mediaQueryLists = [];\n    this.parent = parent;\n    this.__check = this.check.bind(this);\n  }\n\n  init() {\n    const drawers = document.querySelectorAll(`[data-${this.parent.settings.dataBreakpoint}]`);\n    drawers.forEach((drawer) => {\n      const id = drawer.getAttribute(`data-${this.parent.settings.dataDrawer}`);\n      const key = drawer.getAttribute(`data-${this.parent.settings.dataBreakpoint}`);\n      const bp = this.parent.settings.breakpoints[key] ? this.parent.settings.breakpoints[key] : key;\n      const mql = window.matchMedia('(min-width:' + bp + ')');\n      this.match(mql, drawer);\n      mql.addListener(this.__check);\n      this.mediaQueryLists.push({\n        'mql': mql,\n        'drawer': id\n      });\n    });\n  }\n\n  destroy() {\n    if (this.mediaQueryLists && this.mediaQueryLists.length) {\n      this.mediaQueryLists.forEach((item) => {\n        item.mql.removeListener(this.__check);\n      });\n    }\n    this.mediaQueryLists = null;\n  }\n\n  check(event = null) {\n    if (this.mediaQueryLists && this.mediaQueryLists.length) {\n      this.mediaQueryLists.forEach((item) => {\n        // If an event is passed, filter out drawers that don't match the query\n        // If event is null, run all drawers through match\n        let filter = (event) ? event.media == item.mql.media : true;\n        if (!filter) return;\n        const drawer = document.querySelector(\n          `[data-${this.parent.settings.dataDrawer}=\"${item.drawer}\"]`\n        );\n        if (drawer) this.match(item.mql, drawer);\n      });\n      document.dispatchEvent(new CustomEvent(this.parent.settings.customEventPrefix + 'breakpoint', {\n        bubbles: true\n      }));\n    }\n  }\n\n  match(mql, drawer) {\n    if (mql.matches) {\n      switchToDefault(drawer, this.parent);\n    } else {\n      switchToModal(drawer, this.parent);\n    }\n  }\n}\n","export function handlerClick(event) {\n  // Working catch\n  if (this.working) return;\n\n  // Toggle data trigger\n  let trigger = event.target.closest(`[data-${this.settings.dataToggle}]`);\n  if (trigger) {\n    const selector = trigger.getAttribute(`data-${this.settings.dataToggle}`);\n    this.memory.trigger = trigger;\n    this.toggle(selector);\n    event.preventDefault();\n    return;\n  }\n\n  // Open data trigger\n  trigger = event.target.closest(`[data-${this.settings.dataOpen}]`);\n  if (trigger) {\n    const selector = trigger.getAttribute(`data-${this.settings.dataOpen}`);\n    this.memory.trigger = trigger;\n    this.open(selector);\n    event.preventDefault();\n    return;\n  }\n\n  // Close data trigger\n  trigger = event.target.closest(`[data-${this.settings.dataClose}]`);\n  if (trigger) {\n    const selector = trigger.getAttribute(`data-${this.settings.dataClose}`);\n    if (selector) {\n      this.memory.trigger = trigger;\n      this.close(selector);\n    } else {\n      const target = event.target.closest(`[data-${this.settings.dataDrawer}]`);\n      if (target) this.close(target);\n    }\n    event.preventDefault();\n    return;\n  }\n\n  // Screen modal trigger\n  if (event.target.hasAttribute(`data-${this.settings.dataDrawer}`)) {\n    this.close(event.target);\n    return;\n  }\n}\n\nexport function handlerKeyup(event) {\n  // Working catch\n  if (this.working) return;\n\n  if (event.keyCode == 27) {\n    const target = document.querySelector(\n      `.${this.settings.classModal}.${this.settings.stateOpened}`\n    );\n    if (target) {\n      this.close(target);\n    }\n  }\n}\n","import { addClass, hasClass, removeClass } from '@vrembem/core/index';\n\nexport function stateSet(settings) {\n  // If save state is disabled\n  if (!settings.stateSave)\n    return stateClear(settings);\n\n  // If there isn't an existing state to set\n  if (!localStorage.getItem(settings.stateKey))\n    return stateSave(null, settings);\n\n  // Set the existing state\n  const state = JSON.parse(localStorage.getItem(settings.stateKey));\n  Object.keys(state).forEach((key) => {\n    const item = document.querySelector(\n      `[data-${settings.dataDrawer}=\"${key}\"]`\n    );\n    if (!item) return;\n    (state[key] == settings.stateOpened) ?\n      addClass(item, settings.stateOpened) :\n      removeClass(item, settings.stateOpened);\n  });\n  return state;\n}\n\nexport function stateSave(target, settings) {\n  // If save state is disabled\n  if (!settings.stateSave)\n    return stateClear(settings);\n\n  // Get the currently saved object if it exists\n  const state = (localStorage.getItem(settings.stateKey)) ?\n    JSON.parse(localStorage.getItem(settings.stateKey)) : {};\n\n  // Are we saving a single target or the entire suite?\n  const drawers = (target) ? [target] :\n    document.querySelectorAll(`[data-${settings.dataDrawer}]`);\n\n  // Loop through drawers and save their states\n  drawers.forEach((el) => {\n    if (hasClass(el, settings.classModal)) return;\n    const drawerKey = el.getAttribute(`data-${settings.dataDrawer}`);\n    state[drawerKey] = (hasClass(el, settings.stateOpened)) ?\n      settings.stateOpened : settings.stateClosed;\n  });\n\n  // Save to localStorage and return the state\n  localStorage.setItem(settings.stateKey, JSON.stringify(state));\n  return state;\n}\n\nexport function stateClear(settings) {\n  if (localStorage.getItem(settings.stateKey)) {\n    localStorage.removeItem(settings.stateKey);\n  }\n  return {};\n}\n","import { hasClass } from '@vrembem/core/index';\nimport { setInert, setOverflowHidden, setTabindex } from '@vrembem/core/index';\nimport { FocusTrap, focusTarget, focusTrigger } from '@vrembem/core/index';\nimport { openTransition, closeTransition } from '@vrembem/core/index';\n\nimport defaults from './src/js/defaults';\nimport { Breakpoint } from './src/js/breakpoint';\nimport { handlerClick, handlerKeyup } from './src/js/handlers';\nimport { stateClear, stateSave, stateSet } from './src/js/state';\nimport { switchToDefault, switchToModal } from './src/js/switchTo';\n\nexport default class Drawer {\n  constructor(options) {\n    this.defaults = defaults;\n    this.settings = { ...this.defaults, ...options };\n    this.working = false;\n    this.memory = {};\n    this.state = {};\n    this.focusTrap = new FocusTrap();\n    this.breakpoint = new Breakpoint(this);\n    this.__handlerClick = handlerClick.bind(this);\n    this.__handlerKeyup = handlerKeyup.bind(this);\n    if (this.settings.autoInit) this.init();\n  }\n\n  init(options = null) {\n    if (options) this.settings = { ...this.settings, ...options };\n    this.stateSet();\n    this.setTabindex(this.settings.setTabindex);\n    this.breakpoint.init();\n    document.addEventListener('click', this.__handlerClick, false);\n    document.addEventListener('touchend', this.__handlerClick, false);\n    document.addEventListener('keyup', this.__handlerKeyup, false);\n  }\n\n  destroy() {\n    this.breakpoint.destroy();\n    this.memory = {};\n    this.state = {};\n    localStorage.removeItem(this.settings.stateKey);\n    document.removeEventListener('click', this.__handlerClick, false);\n    document.removeEventListener('touchend', this.__handlerClick, false);\n    document.removeEventListener('keyup', this.__handlerKeyup, false);\n  }\n\n  /**\n   * Helpers\n   */\n\n  getDrawer(drawerKey) {\n    if (typeof drawerKey !== 'string') return drawerKey;\n    return document.querySelector(\n      `[data-${this.settings.dataDrawer}=\"${drawerKey}\"]`\n    );\n  }\n\n  drawerNotFound(key) {\n    return Promise.reject(\n      new Error(`Did not find drawer with key: \"${key}\"`)\n    );\n  }\n\n  setTabindex(state = true) {\n    const selectorTabindex = `\n      [data-${this.settings.dataDrawer}]\n      [data-${this.settings.dataDialog}]\n    `;\n    setTabindex(state, selectorTabindex);\n  }\n\n  /**\n   * Save state functionality\n   */\n\n  stateSet() {\n    this.state = stateSet(this.settings);\n  }\n\n  stateSave(target = null) {\n    this.state = stateSave(target, this.settings);\n  }\n\n  stateClear() {\n    this.state = stateClear(this.settings);\n  }\n\n  /**\n   * SwitchTo functionality\n   */\n\n  switchToDefault(drawerKey) {\n    return switchToDefault(drawerKey, this);\n  }\n\n  switchToModal(drawerKey) {\n    return switchToModal(drawerKey, this);\n  }\n\n  /**\n   * Change state functionality\n   */\n\n  async toggle(drawerKey) {\n    const drawer = this.getDrawer(drawerKey);\n    if (!drawer) return this.drawerNotFound(drawerKey);\n    const isOpen = hasClass(drawer, this.settings.stateOpened);\n    if (!isOpen) {\n      return this.open(drawer);\n    } else {\n      return this.close(drawer);\n    }\n  }\n\n  async open(drawerKey) {\n    const drawer = this.getDrawer(drawerKey);\n    if (!drawer) return this.drawerNotFound(drawerKey);\n    if (!hasClass(drawer, this.settings.stateOpened)) {\n      this.working = true;\n      const isModal = hasClass(drawer, this.settings.classModal);\n      if (isModal) {\n        setOverflowHidden(true, this.settings.selectorOverflow);\n      }\n      await openTransition(drawer, this.settings);\n      this.stateSave(drawer);\n      if (isModal) {\n        this.focusTrap.init(drawer);\n        setInert(true, this.settings.selectorInert);\n      }\n      focusTarget(drawer, this.settings);\n      drawer.dispatchEvent(new CustomEvent(this.settings.customEventPrefix + 'opened', {\n        bubbles: true\n      }));\n      this.working = false;\n      return drawer;\n    } else {\n      focusTarget(drawer, this.settings);\n      return drawer;\n    }\n  }\n\n  async close(drawerKey) {\n    const drawer = this.getDrawer(drawerKey);\n    if (!drawer) return this.drawerNotFound(drawerKey);\n    if (hasClass(drawer, this.settings.stateOpened)) {\n      this.working = true;\n      if (hasClass(drawer, this.settings.classModal)) {\n        setInert(false, this.settings.selectorInert);\n        setOverflowHidden(false, this.settings.selectorOverflow);\n      }\n      await closeTransition(drawer, this.settings);\n      this.stateSave(drawer);\n      focusTrigger(this);\n      this.focusTrap.destroy();\n      drawer.dispatchEvent(new CustomEvent(this.settings.customEventPrefix + 'closed', {\n        bubbles: true\n      }));\n      this.working = false;\n      return drawer;\n    } else {\n      return drawer;\n    }\n  }\n}\n"],"names":["setInert","state","selector","els","document","querySelectorAll","forEach","el","inert","setAttribute","removeAttribute","setOverflowHidden","style","overflow","removeProperty","setTabindex","addClass","classList","add","focusTarget","target","settings","innerFocus","querySelector","dataFocus","focus","innerElement","focusTrigger","obj","memory","trigger","FocusTrap","__handlerFocusTrap","handlerFocusTrap","bind","init","inner","focusable","getFocusable","length","focusableFirst","focusableLast","addEventListener","handlerFocusLock","destroy","removeEventListener","event","isTab","key","keyCode","shiftKey","activeElement","preventDefault","initFocus","initScrollTop","scrollTop","push","hasClass","slice","call","some","cl","contains","removeClass","remove","openTransition","Promise","resolve","transition","stateClosed","stateOpening","_f","stateOpened","closeTransition","stateClosing","breakpoints","xs","sm","md","lg","xl","autoInit","dataDrawer","dataDialog","dataToggle","dataOpen","dataClose","dataBreakpoint","classModal","selectorInert","selectorOverflow","customEventPrefix","stateSave","stateKey","switchToDefault","drawerKey","drawer","getDrawer","drawerNotFound","focusTrap","getAttribute","drawerState","dispatchEvent","CustomEvent","bubbles","switchToModal","Breakpoint","parent","mediaQueryLists","__check","check","drawers","id","bp","mql","window","matchMedia","match","addListener","item","removeListener","filter","media","matches","handlerClick","working","closest","toggle","open","close","hasAttribute","handlerKeyup","stateSet","stateClear","localStorage","getItem","JSON","parse","Object","keys","setItem","stringify","removeItem","Drawer","options","defaults","breakpoint","__handlerClick","__handlerKeyup","reject","Error","selectorTabindex","isOpen","isModal"],"mappings":"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"}
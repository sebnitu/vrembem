{"version":3,"file":"scripts.umd.js","sources":["../src/js/defaults.js","../src/js/switchTo.js","../src/js/breakpoint.js","../src/js/handlers.js","../src/js/state.js","../index.js"],"sourcesContent":["import { breakpoints } from '@vrembem/core/index';\n\nexport default {\n  autoInit: false,\n\n  // Data attributes\n  dataDrawer: 'drawer',\n  dataDialog: 'drawer-dialog',\n  dataToggle: 'drawer-toggle',\n  dataOpen: 'drawer-open',\n  dataClose: 'drawer-close',\n  dataBreakpoint: 'drawer-breakpoint',\n  dataFocus: 'drawer-focus',\n\n  // State classes\n  stateOpened: 'is-opened',\n  stateOpening: 'is-opening',\n  stateClosing: 'is-closing',\n  stateClosed: 'is-closed',\n\n  // Classes\n  classModal: 'drawer_modal',\n\n  // Selectors\n  selectorInert: null,\n  selectorOverflow: null,\n\n  // Feature toggles\n  breakpoints: breakpoints,\n  customEventPrefix: 'drawer:',\n  stateSave: true,\n  stateKey: 'DrawerState',\n  setTabindex: true,\n  transition: true\n};\n","import { addClass, hasClass, removeClass } from '@vrembem/core/index';\nimport { setInert, setOverflowHidden } from '@vrembem/core/index';\n\nexport async function switchToModal(drawerKey, obj) {\n  // Initial guards\n  const drawer = obj.getDrawer(drawerKey);\n  if (!drawer) return obj.drawerNotFound(drawerKey);\n  if (hasClass(drawer, obj.settings.classModal)) return;\n\n  // Enable modal state\n  addClass(drawer, obj.settings.classModal);\n  addClass(drawer, obj.settings.stateClosed);\n  removeClass(drawer, obj.settings.stateOpened);\n\n  // Dispatch custom event\n  drawer.dispatchEvent(new CustomEvent(obj.settings.customEventPrefix + 'toModal', {\n    bubbles: true\n  }));\n  return drawer;\n}\n\nexport async function switchToDefault(drawerKey, obj) {\n  // Initial guards\n  const drawer = obj.getDrawer(drawerKey);\n  if (!drawer) return obj.drawerNotFound(drawerKey);\n  if (!hasClass(drawer, obj.settings.classModal)) return;\n\n  // Tear down modal state\n  setInert(false, obj.settings.selectorInert);\n  setOverflowHidden(false, obj.settings.selectorOverflow);\n  removeClass(drawer, obj.settings.classModal);\n  obj.focusTrap.destroy();\n\n  // Restore drawers saved state\n  drawerKey = drawer.getAttribute(`data-${obj.settings.dataDrawer}`);\n  const drawerState = obj.state[drawerKey];\n  if (drawerState == obj.settings.stateOpened) {\n    addClass(drawer, obj.settings.stateOpened);\n    removeClass(drawer, obj.settings.stateClosed);\n  }\n\n  // Dispatch custom event\n  drawer.dispatchEvent(new CustomEvent(obj.settings.customEventPrefix + 'toDefault', {\n    bubbles: true\n  }));\n  return drawer;\n}\n","import { switchToDefault, switchToModal } from './switchTo';\n\nexport class Breakpoint {\n  constructor(parent) {\n    this.mediaQueryLists = [];\n    this.parent = parent;\n    this.__check = this.check.bind(this);\n  }\n\n  init() {\n    const drawers = document.querySelectorAll(`[data-${this.parent.settings.dataBreakpoint}]`);\n    drawers.forEach((drawer) => {\n      const id = drawer.getAttribute(`data-${this.parent.settings.dataDrawer}`);\n      const key = drawer.getAttribute(`data-${this.parent.settings.dataBreakpoint}`);\n      const bp = this.parent.settings.breakpoints[key] ? this.parent.settings.breakpoints[key] : key;\n      const mql = window.matchMedia('(min-width:' + bp + ')');\n      this.match(mql, drawer);\n      mql.addListener(this.__check);\n      this.mediaQueryLists.push({\n        'mql': mql,\n        'drawer': id\n      });\n    });\n  }\n\n  destroy() {\n    if (this.mediaQueryLists && this.mediaQueryLists.length) {\n      this.mediaQueryLists.forEach((item) => {\n        item.mql.removeListener(this.__check);\n      });\n    }\n    this.mediaQueryLists = null;\n  }\n\n  check(event = null) {\n    if (this.mediaQueryLists && this.mediaQueryLists.length) {\n      this.mediaQueryLists.forEach((item) => {\n        // If an event is passed, filter out drawers that don't match the query\n        // If event is null, run all drawers through match\n        let filter = (event) ? event.media == item.mql.media : true;\n        if (!filter) return;\n        const drawer = document.querySelector(\n          `[data-${this.parent.settings.dataDrawer}=\"${item.drawer}\"]`\n        );\n        if (drawer) this.match(item.mql, drawer);\n      });\n      document.dispatchEvent(new CustomEvent(this.parent.settings.customEventPrefix + 'breakpoint', {\n        bubbles: true\n      }));\n    }\n  }\n\n  match(mql, drawer) {\n    if (mql.matches) {\n      switchToDefault(drawer, this.parent);\n    } else {\n      switchToModal(drawer, this.parent);\n    }\n  }\n}\n","export function handlerClick(event) {\n  // Working catch\n  if (this.working) return;\n\n  // Toggle data trigger\n  let trigger = event.target.closest(`[data-${this.settings.dataToggle}]`);\n  if (trigger) {\n    const selector = trigger.getAttribute(`data-${this.settings.dataToggle}`);\n    this.memory.trigger = trigger;\n    this.toggle(selector);\n    event.preventDefault();\n    return;\n  }\n\n  // Open data trigger\n  trigger = event.target.closest(`[data-${this.settings.dataOpen}]`);\n  if (trigger) {\n    const selector = trigger.getAttribute(`data-${this.settings.dataOpen}`);\n    this.memory.trigger = trigger;\n    this.open(selector);\n    event.preventDefault();\n    return;\n  }\n\n  // Close data trigger\n  trigger = event.target.closest(`[data-${this.settings.dataClose}]`);\n  if (trigger) {\n    const selector = trigger.getAttribute(`data-${this.settings.dataClose}`);\n    if (selector) {\n      this.memory.trigger = trigger;\n      this.close(selector);\n    } else {\n      const target = event.target.closest(`[data-${this.settings.dataDrawer}]`);\n      if (target) this.close(target);\n    }\n    event.preventDefault();\n    return;\n  }\n\n  // Screen modal trigger\n  if (event.target.hasAttribute(`data-${this.settings.dataDrawer}`)) {\n    this.close(event.target);\n    return;\n  }\n}\n\nexport function handlerKeyup(event) {\n  // Working catch\n  if (this.working) return;\n\n  if (event.keyCode == 27) {\n    const target = document.querySelector(\n      `.${this.settings.classModal}.${this.settings.stateOpened}`\n    );\n    if (target) {\n      this.close(target);\n    }\n  }\n}\n","import { addClass, hasClass, removeClass } from '@vrembem/core/index';\n\nexport function stateSet(settings) {\n  // If save state is disabled\n  if (!settings.stateSave)\n    return stateClear(settings);\n\n  // If there isn't an existing state to set\n  if (!localStorage.getItem(settings.stateKey))\n    return stateSave(null, settings);\n\n  // Set the existing state\n  const state = JSON.parse(localStorage.getItem(settings.stateKey));\n  Object.keys(state).forEach((key) => {\n    const item = document.querySelector(\n      `[data-${settings.dataDrawer}=\"${key}\"]`\n    );\n    if (!item) return;\n    (state[key] == settings.stateOpened) ?\n      addClass(item, settings.stateOpened) :\n      removeClass(item, settings.stateOpened);\n  });\n  return state;\n}\n\nexport function stateSave(target, settings) {\n  // If save state is disabled\n  if (!settings.stateSave)\n    return stateClear(settings);\n\n  // Get the currently saved object if it exists\n  const state = (localStorage.getItem(settings.stateKey)) ?\n    JSON.parse(localStorage.getItem(settings.stateKey)) : {};\n\n  // Are we saving a single target or the entire suite?\n  const drawers = (target) ? [target] :\n    document.querySelectorAll(`[data-${settings.dataDrawer}]`);\n\n  // Loop through drawers and save their states\n  drawers.forEach((el) => {\n    if (hasClass(el, settings.classModal)) return;\n    const drawerKey = el.getAttribute(`data-${settings.dataDrawer}`);\n    state[drawerKey] = (hasClass(el, settings.stateOpened)) ?\n      settings.stateOpened : settings.stateClosed;\n  });\n\n  // Save to localStorage and return the state\n  localStorage.setItem(settings.stateKey, JSON.stringify(state));\n  return state;\n}\n\nexport function stateClear(settings) {\n  if (localStorage.getItem(settings.stateKey)) {\n    localStorage.removeItem(settings.stateKey);\n  }\n  return {};\n}\n","import { hasClass } from '@vrembem/core/index';\nimport { setInert, setOverflowHidden, setTabindex } from '@vrembem/core/index';\nimport { FocusTrap, focusTarget, focusTrigger } from '@vrembem/core/index';\nimport { openTransition, closeTransition } from '@vrembem/core/index';\n\nimport defaults from './src/js/defaults';\nimport { Breakpoint } from './src/js/breakpoint';\nimport { handlerClick, handlerKeyup } from './src/js/handlers';\nimport { stateClear, stateSave, stateSet } from './src/js/state';\nimport { switchToDefault, switchToModal } from './src/js/switchTo';\n\nexport default class Drawer {\n  constructor(options) {\n    this.defaults = defaults;\n    this.settings = { ...this.defaults, ...options };\n    this.working = false;\n    this.memory = {};\n    this.state = {};\n    this.focusTrap = new FocusTrap();\n    this.breakpoint = new Breakpoint(this);\n    this.__handlerClick = handlerClick.bind(this);\n    this.__handlerKeyup = handlerKeyup.bind(this);\n    if (this.settings.autoInit) this.init();\n  }\n\n  init(options = null) {\n    if (options) this.settings = { ...this.settings, ...options };\n    this.stateSet();\n    this.setTabindex(this.settings.setTabindex);\n    this.breakpoint.init();\n    document.addEventListener('click', this.__handlerClick, false);\n    document.addEventListener('touchend', this.__handlerClick, false);\n    document.addEventListener('keyup', this.__handlerKeyup, false);\n  }\n\n  destroy() {\n    this.breakpoint.destroy();\n    this.memory = {};\n    this.state = {};\n    localStorage.removeItem(this.settings.stateKey);\n    document.removeEventListener('click', this.__handlerClick, false);\n    document.removeEventListener('touchend', this.__handlerClick, false);\n    document.removeEventListener('keyup', this.__handlerKeyup, false);\n  }\n\n  /**\n   * Helpers\n   */\n\n  getDrawer(drawerKey) {\n    if (typeof drawerKey !== 'string') return drawerKey;\n    return document.querySelector(\n      `[data-${this.settings.dataDrawer}=\"${drawerKey}\"]`\n    );\n  }\n\n  drawerNotFound(key) {\n    return Promise.reject(\n      new Error(`Did not find drawer with key: \"${key}\"`)\n    );\n  }\n\n  setTabindex(state = true) {\n    const selectorTabindex = `\n      [data-${this.settings.dataDrawer}]\n      [data-${this.settings.dataDialog}]\n    `;\n    setTabindex(state, selectorTabindex);\n  }\n\n  /**\n   * Save state functionality\n   */\n\n  stateSet() {\n    this.state = stateSet(this.settings);\n  }\n\n  stateSave(target = null) {\n    this.state = stateSave(target, this.settings);\n  }\n\n  stateClear() {\n    this.state = stateClear(this.settings);\n  }\n\n  /**\n   * SwitchTo functionality\n   */\n\n  switchToDefault(drawerKey) {\n    return switchToDefault(drawerKey, this);\n  }\n\n  switchToModal(drawerKey) {\n    return switchToModal(drawerKey, this);\n  }\n\n  /**\n   * Change state functionality\n   */\n\n  async toggle(drawerKey) {\n    const drawer = this.getDrawer(drawerKey);\n    if (!drawer) return this.drawerNotFound(drawerKey);\n    const isOpen = hasClass(drawer, this.settings.stateOpened);\n    if (!isOpen) {\n      return this.open(drawer);\n    } else {\n      return this.close(drawer);\n    }\n  }\n\n  async open(drawerKey) {\n    const drawer = this.getDrawer(drawerKey);\n    if (!drawer) return this.drawerNotFound(drawerKey);\n    if (!hasClass(drawer, this.settings.stateOpened)) {\n      this.working = true;\n      const isModal = hasClass(drawer, this.settings.classModal);\n      if (isModal) {\n        setOverflowHidden(true, this.settings.selectorOverflow);\n      }\n      await openTransition(drawer, this.settings);\n      this.stateSave(drawer);\n      if (isModal) {\n        this.focusTrap.init(drawer);\n        setInert(true, this.settings.selectorInert);\n      }\n      focusTarget(drawer, this.settings);\n      drawer.dispatchEvent(new CustomEvent(this.settings.customEventPrefix + 'opened', {\n        bubbles: true\n      }));\n      this.working = false;\n      return drawer;\n    } else {\n      focusTarget(drawer, this.settings);\n      return drawer;\n    }\n  }\n\n  async close(drawerKey) {\n    const drawer = this.getDrawer(drawerKey);\n    if (!drawer) return this.drawerNotFound(drawerKey);\n    if (hasClass(drawer, this.settings.stateOpened)) {\n      this.working = true;\n      if (hasClass(drawer, this.settings.classModal)) {\n        setInert(false, this.settings.selectorInert);\n        setOverflowHidden(false, this.settings.selectorOverflow);\n      }\n      await closeTransition(drawer, this.settings);\n      this.stateSave(drawer);\n      focusTrigger(this);\n      this.focusTrap.destroy();\n      drawer.dispatchEvent(new CustomEvent(this.settings.customEventPrefix + 'closed', {\n        bubbles: true\n      }));\n      this.working = false;\n      return drawer;\n    } else {\n      return drawer;\n    }\n  }\n}\n"],"names":["autoInit","dataDrawer","dataDialog","dataToggle","dataOpen","dataClose","dataBreakpoint","dataFocus","stateOpened","stateOpening","stateClosing","stateClosed","classModal","selectorInert","selectorOverflow","breakpoints","customEventPrefix","stateSave","stateKey","setTabindex","transition","switchToDefault","drawerKey","obj","drawer","getDrawer","drawerNotFound","hasClass","settings","setInert","setOverflowHidden","removeClass","focusTrap","destroy","getAttribute","drawerState","state","addClass","dispatchEvent","CustomEvent","bubbles","switchToModal","Breakpoint","parent","mediaQueryLists","__check","check","bind","init","drawers","document","querySelectorAll","forEach","id","key","bp","mql","window","matchMedia","match","addListener","push","length","item","removeListener","event","filter","media","querySelector","matches","handlerClick","working","trigger","target","closest","selector","memory","toggle","preventDefault","open","close","hasAttribute","handlerKeyup","keyCode","stateSet","stateClear","localStorage","getItem","JSON","parse","Object","keys","el","setItem","stringify","removeItem","Drawer","options","defaults","FocusTrap","breakpoint","__handlerClick","__handlerKeyup","addEventListener","removeEventListener","Promise","reject","Error","selectorTabindex","isOpen","isModal","openTransition","focusTarget","closeTransition","focusTrigger"],"mappings":"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"}